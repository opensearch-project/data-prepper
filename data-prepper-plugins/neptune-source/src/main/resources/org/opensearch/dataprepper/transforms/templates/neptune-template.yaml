version: "2"
neptune-pipeline:
  source:
    neptune:
      port: 8182
      region: "us-west-2"
      iamAuth: false
      aws:
        sts_role_arn: "arn:aws:iam::<<aws_account_id>>:role/<<roleName>>"
      s3_bucket: "data-prepper-test"
      s3_region: "us-west-2"
      host: "localhost" # Set up SSH tunnel to remote Neptune cluster
      # host: "db-neptune-1.cluster-...us-west-2.neptune.amazonaws.com"
      acknowledgments: false
      export: false
      stream: true
      streamType: "propertygraph"
  sink:
    - opensearch:
        hosts:
          [
            "https://search-os-docdb-test-...aos.us-west-2.on.aws"
          ]
        index: "neptune"
        index_type: custom
        document_id: "${getMetadata(\"id\")}"
        action: "${getMetadata(\"opensearch_action\")}"
        # Neptune record creation or event timestamp
        # document_version: "${getMetadata(\"document_version\")}"
        # document_version_type: "external"
        aws:
          sts_role_arn: "arn:aws:iam::<<aws_account_id>>:role/<<roleName>>"
          region: "us-west-2"
