{
  "mapping_options": {
    "authentication": {
      "direct_mappings": [
        {
          "source": "UserType",
          "destination": "actor.user.type_id",
          "type": "integer"
        }
      ],
      "transformations": [
        {
          "transformation": "literal",
          "target": "class_name",
          "value": "Authentication",
          "type": "string"
        },
        {
          "transformation": "conditional",
          "if": {
            "condition": {
              "logic": "OR",
              "clauses": [
                {
                  "lhs": {
                    "type": "field",
                    "value": "Operation"
                  },
                  "operation": "EQUALS",
                  "rhs": {
                    "type": "pattern",
                    "value": "UserLoggedIn"
                  }
                }
              ]
            },
            "operations": [
              {
                "operation": "literal",
                "target": "activity_name",
                "value": "Logon",
                "type": "string"
              }
            ]
          }
        },
        {
          "transformation": "enum",
          "source": "ResultStatus",
          "target": "status_id",
          "type": "integer",
          "default": 0,
          "cases": [
            {
              "from": "Success",
              "to": 1
            }
          ]
        }
      ]
    },
    "exchange_activity": {
      "direct_mappings": [],
      "transformations": [
        {
          "transformation": "literal",
          "target": "class_name",
          "value": "Email Activity",
          "type": "string"
        },
        {
          "transformation": "conditional",
          "if": {
            "condition": {
              "logic": "OR",
              "clauses": [
                {
                  "lhs": {
                    "type": "field",
                    "value": "Operation"
                  },
                  "operation": "EQUALS",
                  "rhs": {
                    "type": "pattern",
                    "value": "Create"
                  }
                }
              ]
            },
            "operations": [
              {
                "operation": "literal",
                "target": "activity_name",
                "value": "Send",
                "type": "string"
              }
            ]
          }
        }
      ]
    },
    "sharepoint_activity": {
      "direct_mappings": [
        {
          "source": "ObjectId",
          "destination": "web_resources[].url_string",
          "type": "string"
        },
        {
          "source": "Site",
          "destination": "web_resources[].uid",
          "type": "string"
        }
      ],
      "transformations": [
        {
          "transformation": "literal",
          "target": "class_name",
          "value": "Web Resources Activity",
          "type": "string"
        },
        {
          "transformation": "conditional",
          "if": {
            "condition": {
              "logic": "OR",
              "clauses": [
                {
                  "lhs": {
                    "type": "field",
                    "value": "Operation"
                  },
                  "operation": "EQUALS",
                  "rhs": {
                    "type": "pattern",
                    "value": "PageViewed"
                  }
                }
              ]
            },
            "operations": [
              {
                "operation": "literal",
                "target": "activity_name",
                "value": "Read",
                "type": "string"
              }
            ]
          }
        }
      ]
    }
  },
  "mapping_selector": {
    "cases": [
      {
        "condition": {
          "clauses": [
            {
              "lhs": {
                "type": "field",
                "value": "Workload"
              },
              "operation": "EQUALS",
              "rhs": {
                "type": "string",
                "value": "AzureActiveDirectory"
              }
            }
          ]
        },
        "selection": "authentication"
      },
      {
        "condition": {
          "clauses": [
            {
              "lhs": {
                "type": "field",
                "value": "Workload"
              },
              "operation": "EQUALS",
              "rhs": {
                "type": "string",
                "value": "Exchange"
              }
            }
          ]
        },
        "selection": "exchange_activity"
      },
      {
        "condition": {
          "clauses": [
            {
              "lhs": {
                "type": "field",
                "value": "Workload"
              },
              "operation": "EQUALS",
              "rhs": {
                "type": "string",
                "value": "SharePoint"
              }
            }
          ]
        },
        "selection": "sharepoint_activity"
      }
    ],
    "default_selection": "authentication"
  }
}